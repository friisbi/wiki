<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        {% block title %}
        {{_("Frappe Wiki")}}
        {% endblock %}
    </title>

    <link rel="stylesheet" href="/assets/wiki/css/tailwind.css?v={{get_tailwindcss_hash()}}">
    <link rel="stylesheet" href="/assets/frappe/css/hljs-night-owl.css">

    <!-- Hide x-cloak elements until Alpine loads -->
    <style>[x-cloak] { display: none !important; }</style>

    <!-- Theme initialization - must run before page renders to prevent flash -->
    <script>
        (function() {
            const stored = localStorage.getItem('data-theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = stored || (prefersDark ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', theme);
        })();

        // CSRF token for API requests
        window.CSRF_TOKEN = '{{ csrf_token }}';
    </script>

    <script src="/assets/wiki/js/vendor/alpinejs/plugins/persist.js"></script>
    <script src="/assets/wiki/js/vendor/alpinejs/plugins/collapse.js"></script>

    <script defer src="/assets/wiki/js/vendor/alpinejs/core.js"></script>

    {% block head %} {% endblock %}
</head>
<body class="min-h-screen bg-[var(--surface-white)] text-[var(--ink-gray-9)]">
    {% include "templates/wiki/includes/sidebar.html" %}
    {% include "templates/wiki/includes/search_modal.html" %}

    <div class="min-h-screen transition-all duration-300"
         x-data
         :class="$store.sidebar.isCollapsed ? 'xl:ml-0' : 'xl:ml-72'">
        {% include "templates/wiki/includes/mobile_header.html" %}
        {% include "templates/wiki/includes/header.html" %}
        <main class="px-4 py-6 lg:px-6 lg:py-8 xl:px-12">
            {% block body %} {% endblock %}
        </main>
    </div>
    
    {{ include_script("syntax_highlighting.bundle.js") }}
    <script src="/assets/wiki/js/code-blocks.js"></script>
</body>
{% block scripts %} {% endblock %}
</html>