{# Ghost Button Macro
   Usage:
   {{ ghost_button(text="Click me", icon="clipboard", href="/path", click="handleClick()") }}

   Parameters:
   - text: Button text (required)
   - icon: Icon name - clipboard, check, edit, sun, moon, chevron-left, chevron-right, collapse, expand (optional)
   - href: If provided, renders as <a> tag, otherwise <button> (optional)
   - click: Alpine.js @click handler (optional)
   - x_show: Alpine.js x-show condition (optional)
   - x_text: Alpine.js x-text for dynamic text (optional)
   - extra_classes: Additional CSS classes (optional)
   - icon_classes: Additional classes for the icon (optional)
   - id: HTML id attribute (optional)
#}

{% macro ghost_button(text="", icon="", href="", click="", x_show="", x_text="", extra_classes="", icon_classes="", id="") %}
    {% set base_classes = "inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-[var(--ink-gray-5)] hover:text-[var(--ink-gray-9)] hover:bg-[var(--surface-gray-2)] rounded-md transition-colors duration-200 cursor-pointer" %}

    {% if href %}
    <a href="{{ href }}"
       {% if id %}id="{{ id }}"{% endif %}
       class="{{ base_classes }} {{ extra_classes }}"
       {% if x_show %}x-show="{{ x_show }}"{% endif %}>
        {{ render_icon(icon, icon_classes) }}
        {% if x_text %}
        <span x-text="{{ x_text }}">{{ text }}</span>
        {% else %}
        <span>{{ text }}</span>
        {% endif %}
    </a>
    {% else %}
    <button {% if click %}@click="{{ click }}"{% endif %}
            {% if id %}id="{{ id }}"{% endif %}
            class="{{ base_classes }} {{ extra_classes }}"
            {% if x_show %}x-show="{{ x_show }}"{% endif %}>
        {{ render_icon(icon, icon_classes) }}
        {% if x_text %}
        <span x-text="{{ x_text }}">{{ text }}</span>
        {% else %}
        <span>{{ text }}</span>
        {% endif %}
    </button>
    {% endif %}
{% endmacro %}

{# Full-width Ghost Button (for sidebar footer buttons) #}
{% macro ghost_button_full(text="", icon="", click="", x_show="", x_text="", extra_classes="", icon_classes="") %}
    {% set base_classes = "w-full flex items-center justify-center px-3 py-2 text-sm font-medium text-[var(--ink-gray-5)] hover:text-[var(--ink-gray-9)] hover:bg-[var(--surface-gray-2)] rounded-md transition-colors duration-200 cursor-pointer" %}

    <button {% if click %}@click="{{ click }}"{% endif %}
            class="{{ base_classes }} {{ extra_classes }}"
            {% if x_show %}x-show="{{ x_show }}"{% endif %}>
        {{ render_icon(icon, icon_classes) }}
        {% if x_text %}
        <span x-text="{{ x_text }}">{{ text }}</span>
        {% else %}
        <span>{{ text }}</span>
        {% endif %}
    </button>
{% endmacro %}

{# Dropdown Menu Macro
   Usage:
   {{ dropdown(text="Ask AI", icon="sparkles", id="ai-dropdown") }}
       {{ dropdown_item(text="Ask Claude", icon="claude", href_expr="getAIUrl('claude')") }}
       {{ dropdown_item(text="Ask OpenAI", icon="openai", href_expr="getAIUrl('openai')") }}
   {{ dropdown_end() }}

   Parameters:
   - text: Button text (required)
   - icon: Icon name for the trigger button (optional)
   - id: Unique identifier for the dropdown (required for Alpine.js state)
   - width: Width class for dropdown menu (default: "w-56")
#}

{% macro dropdown(text="", icon="", id="dropdown", width="w-56") %}
    <div class="relative" x-data="{ open: false }" @click.outside="open = false">
        <button @click="open = !open"
                class="inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-[var(--ink-gray-5)] hover:text-[var(--ink-gray-9)] hover:bg-[var(--surface-gray-2)] rounded-md transition-colors duration-200 cursor-pointer">
            {% if icon %}{{ render_icon(icon) }}{% endif %}
            <span>{{ text }}</span>
            <svg class="w-3 h-3 transition-transform duration-200" :class="{ 'rotate-180': open }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
        </button>

        <div x-show="open"
             x-cloak
             x-transition:enter="transition ease-out duration-100"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-75"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             class="absolute left-0 mt-2 {{ width }} bg-[var(--surface-white)] border border-[var(--outline-gray-1)] rounded-lg shadow-lg z-50 py-1">
{% endmacro %}

{% macro dropdown_item(text="", icon="", href="", href_expr="", target="_blank") %}
    <a {% if href_expr %}:href="{{ href_expr }}"{% else %}href="{{ href }}"{% endif %}
       {% if target %}target="{{ target }}"{% endif %}
       class="flex items-center gap-3 px-4 py-2.5 text-sm text-[var(--ink-gray-7)] hover:bg-[var(--surface-gray-2)] hover:text-[var(--ink-gray-9)] transition-colors duration-150">
        {% if icon %}{{ render_icon(icon) }}{% endif %}
        <span>{{ text }}</span>
    </a>
{% endmacro %}

{% macro dropdown_end() %}
        </div>
    </div>
{% endmacro %}

{# Icon Button (small square button, like the expand sidebar button) #}
{% macro icon_button(icon="", click="", x_show="", extra_classes="", icon_classes="") %}
    {% set base_classes = "flex items-center justify-center w-10 h-10 bg-[var(--surface-white)] border border-[var(--outline-gray-1)] rounded-md shadow-md hover:shadow-lg hover:bg-[var(--surface-gray-1)] transition-all duration-200 cursor-pointer" %}

    <button {% if click %}@click="{{ click }}"{% endif %}
            class="{{ base_classes }} {{ extra_classes }}"
            {% if x_show %}x-show="{{ x_show }}"{% endif %}>
        {{ render_icon(icon, icon_classes if icon_classes else "w-5 h-5 text-[var(--ink-gray-5)]") }}
    </button>
{% endmacro %}

{# Icon Renderer Helper #}
{% macro render_icon(icon, extra_classes="") %}
    {% set icon_base_classes = "w-4 h-4 " ~ extra_classes %}

    {% if icon == "clipboard" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
    </svg>
    {% elif icon == "check" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
    </svg>
    {% elif icon == "edit" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
    </svg>
    {% elif icon == "sun" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
    </svg>
    {% elif icon == "moon" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
    </svg>
    {% elif icon == "chevron-left" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
    </svg>
    {% elif icon == "chevron-right" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
    </svg>
    {% elif icon == "menu" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
    {% elif icon == "x" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
    </svg>
    {% elif icon == "list" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
    </svg>
    {% elif icon == "search" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
    </svg>
    {% elif icon == "sparkles" %}
    <svg class="{{ icon_base_classes }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
    </svg>
    {% elif icon == "claude" %}
    <svg class="{{ icon_base_classes }}" viewBox="0 0 24 24" fill="currentColor">
        <path d="M4.709 15.955l4.72-2.647.08-.23-.08-.128H9.2l-.79-.048-2.698-.165-2.263-.134-.86-.06.144-.472.384-.124 1.116.068 2.01.128 2.322.152.986.062h.222l.058-.2-.238-.2-.632-.472-1.89-1.426-1.963-1.486-.663-.525.35-.36.426.074.636.496 1.58 1.21 1.89 1.436.695.516.174.058.082-.14-.066-.258-.324-1.142-.85-2.96-.42-1.418-.227-.81.465-.227.28.282.29.964.676 2.378.622 2.166.14.482.15.07.15-.14.014-.174-.07-.728-.228-2.47-.174-2.05-.072-.986.502-.035.238.366.086 1.332.106 1.578.15 2.324.12 1.31.032.174.168.08.14-.14.342-.59.884-1.546 1.22-2.11.46-.79.488.2.012.406-.354.638-1.01 1.79-1.17 2.086-.24.434-.008.182.214.104.166-.034.728-.298 2.286-.96 1.616-.676.614-.246.286.42-.12.402-.606.288-1.82.776-2.2.932-.566.244-.08.188.066.164.596.242 2.102.82 1.866.752.55.252-.09.494-.446.14-.744-.282-1.75-.686-2.052-.816-.506-.202-.198.002-.102.192.044.2.366.75 1.082 2.198.794 1.664.186.448-.33.338-.392-.068-.252-.504-.868-1.748-1.03-2.11-.216-.432-.128-.138-.186.034-.08.15.018.36.048.986.098 2.424.034 1.574-.006.446-.486.106-.256-.298-.06-.752-.128-2.33-.084-2.016-.026-.606-.012-.182-.17-.068-.14.128-.37.402-1.55 1.696-1.334 1.428-.658.69-.458-.172-.024-.446.51-.552 1.328-1.452 1.546-1.686.306-.336.048-.204-.166-.112-.238.054-.69.252-2.334.862-1.602.578-.612.202-.33-.372.11-.41.612-.252 2.126-.79 2.178-.804.366-.126.112-.172-.064-.172-.174-.06-.756-.156-2.358-.494-1.632-.35-.586-.144.054-.505.472-.09.786.148 2.08.416 1.958.396.538.11.186-.022.102-.17-.05-.212-.224-.504-.868-1.87-1.11-2.41-.28-.674.396-.282.384.128.21.44.948 2.022 1.088 2.362.21.456.124.154.17-.004.088-.122.058-.396.142-2.382.09-1.666.054-.62.495-.046.262.32.026.82.022 2.164-.006 2.146-.02.412.06.19.178.066.132-.112.268-.304 1.258-1.434 1.598-1.852.38-.44.466.14.064.416z"/>
    </svg>
    {% elif icon == "openai" %}
    <svg class="{{ icon_base_classes }}" viewBox="0 0 24 24" fill="currentColor">
        <path d="M22.282 9.821a5.985 5.985 0 0 0-.516-4.91 6.046 6.046 0 0 0-6.51-2.9A6.065 6.065 0 0 0 4.981 4.18a5.985 5.985 0 0 0-3.998 2.9 6.046 6.046 0 0 0 .743 7.097 5.98 5.98 0 0 0 .51 4.911 6.051 6.051 0 0 0 6.515 2.9A5.985 5.985 0 0 0 13.26 24a6.056 6.056 0 0 0 5.772-4.206 5.99 5.99 0 0 0 3.997-2.9 6.056 6.056 0 0 0-.747-7.073zM13.26 22.43a4.476 4.476 0 0 1-2.876-1.04l.141-.081 4.779-2.758a.795.795 0 0 0 .392-.681v-6.737l2.02 1.168a.071.071 0 0 1 .038.052v5.583a4.504 4.504 0 0 1-4.494 4.494zM3.6 18.304a4.47 4.47 0 0 1-.535-3.014l.142.085 4.783 2.759a.771.771 0 0 0 .78 0l5.843-3.369v2.332a.08.08 0 0 1-.033.062L9.74 19.95a4.5 4.5 0 0 1-6.14-1.646zM2.34 7.896a4.485 4.485 0 0 1 2.366-1.973V11.6a.766.766 0 0 0 .388.676l5.815 3.355-2.02 1.168a.076.076 0 0 1-.071 0l-4.83-2.786A4.504 4.504 0 0 1 2.34 7.872zm16.597 3.855l-5.833-3.387L15.119 7.2a.076.076 0 0 1 .071 0l4.83 2.791a4.494 4.494 0 0 1-.676 8.105v-5.678a.79.79 0 0 0-.407-.667zm2.01-3.023l-.141-.085-4.774-2.782a.776.776 0 0 0-.785 0L9.409 9.23V6.897a.066.066 0 0 1 .028-.061l4.83-2.787a4.5 4.5 0 0 1 6.68 4.66zm-12.64 4.135l-2.02-1.164a.08.08 0 0 1-.038-.057V6.075a4.5 4.5 0 0 1 7.375-3.453l-.142.08L8.704 5.46a.795.795 0 0 0-.393.681zm1.097-2.365l2.602-1.5 2.607 1.5v2.999l-2.597 1.5-2.607-1.5z"/>
    </svg>
    {% elif icon == "t3" %}
    <svg class="{{ icon_base_classes }}" viewBox="0 0 24 24" fill="currentColor">
        <text x="4" y="18" font-family="Arial, sans-serif" font-size="16" font-weight="bold">T3</text>
    </svg>
    {% elif icon == "perplexity" %}
    <svg class="{{ icon_base_classes }}" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v5.7c0 4.47-3.07 8.67-7 9.93-3.93-1.26-7-5.46-7-9.93V6.3l7-3.12zM12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"/>
    </svg>
    {% endif %}
{% endmacro %}
